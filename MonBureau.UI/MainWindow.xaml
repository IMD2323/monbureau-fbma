<!--  ============================================================================  -->
<!--  MainWindow.xaml - Modern Redesign with Complete Localization  -->
<!--  ============================================================================  -->
<Window
    x:Class="MonBureau.UI.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:MonBureau.UI.Controls"
    xmlns:loc="clr-namespace:MonBureau.UI.Markup"
    Title="{loc:Localize AppName}"
    Width="1400"
    Height="900"
    MinWidth="1200"
    MinHeight="700"
    AllowsTransparency="True"
    Background="Transparent"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None">

    <Window.Resources>
        <!--  Nav Button Base Style  -->
        <Style x:Key="NavButton" TargetType="Button">
            <Setter Property="Height" Value="48" />
            <Setter Property="Padding" Value="16,0" />
            <Setter Property="Margin" Value="0,0,0,4" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            Padding="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}"
                            CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource Gray100Brush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--  Active Nav Button  -->
        <Style
            x:Key="ActiveNavButton"
            BasedOn="{StaticResource NavButton}"
            TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimarySubtleBrush}" />
            <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}" />
        </Style>
    </Window.Resources>

    <Border
        Background="{StaticResource BackgroundBrush}"
        BorderBrush="{StaticResource BorderBrush}"
        BorderThickness="1"
        CornerRadius="20">
        <Border.Effect>
            <DropShadowEffect
                BlurRadius="30"
                Opacity="0.2"
                ShadowDepth="0"
                Color="#000000" />
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="70" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  Custom Title Bar  -->
            <Border
                x:Name="HeaderBar"
                Grid.Row="0"
                Background="{StaticResource PrimaryBrush}"
                CornerRadius="20,20,0,0"
                MouseDown="HeaderBar_MouseDown">
                <Grid Margin="24,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!--  Logo & Title  -->
                    <StackPanel
                        Grid.Column="0"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <Border
                            Width="40"
                            Height="40"
                            Margin="0,0,12,0"
                            Background="White"
                            CornerRadius="10">
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource IconFont}"
                                FontSize="20"
                                Foreground="{StaticResource PrimaryBrush}"
                                Text="&#xE7C3;" />
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock
                                FontSize="18"
                                FontWeight="Bold"
                                Foreground="White"
                                Text="{loc:Localize AppName}" />
                            <TextBlock
                                FontSize="11"
                                Foreground="White"
                                Opacity="0.8"
                                Text="{Binding CurrentPageTitle}" />
                        </StackPanel>
                    </StackPanel>

                    <!--  Language Selector  -->
                    <controls:LanguageSelector
                        Grid.Column="2"
                        Margin="0,0,16,0"
                        VerticalAlignment="Center" />

                    <!--  Window Controls  -->
                    <StackPanel
                        Grid.Column="3"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <Button
                            x:Name="MinimizeButton"
                            Width="40"
                            Height="40"
                            Click="MinimizeButton_Click"
                            Style="{StaticResource IconButton}">
                            <TextBlock
                                FontFamily="{StaticResource IconFont}"
                                FontSize="14"
                                Foreground="White"
                                Text="&#xE921;" />
                        </Button>

                        <Button
                            x:Name="MaximizeButton"
                            Width="40"
                            Height="40"
                            Click="MaximizeButton_Click"
                            Style="{StaticResource IconButton}">
                            <TextBlock
                                FontFamily="{StaticResource IconFont}"
                                FontSize="14"
                                Foreground="White"
                                Text="&#xE922;" />
                        </Button>

                        <Button
                            x:Name="CloseButton"
                            Width="40"
                            Height="40"
                            Click="CloseButton_Click"
                            Style="{StaticResource IconButton}">
                            <TextBlock
                                FontFamily="{StaticResource IconFont}"
                                FontSize="14"
                                Foreground="White"
                                Text="&#xE8BB;" />
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!--  Main Content Area  -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="260" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!--  Sidebar Navigation  -->
                <Border
                    Grid.Column="0"
                    Background="{StaticResource BackgroundSecondaryBrush}"
                    BorderBrush="{StaticResource DividerBrush}"
                    BorderThickness="0,0,1,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Navigation Items  -->
                        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="16,20">
                                <!--  Dashboard  -->
                                <Button
                                    x:Name="DashboardButton"
                                    Click="NavigateToDashboard_Click"
                                    Style="{StaticResource ActiveNavButton}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource IconFont}"
                                            FontSize="18"
                                            Text="&#xE80F;" />
                                        <TextBlock VerticalAlignment="Center" Text="{loc:Localize Nav_Dashboard}" />
                                    </StackPanel>
                                </Button>

                                <!--  Clients  -->
                                <Button
                                    x:Name="ClientsButton"
                                    Click="NavigateToClients_Click"
                                    Style="{StaticResource NavButton}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource IconFont}"
                                            FontSize="18"
                                            Foreground="{StaticResource TextSecondaryBrush}"
                                            Text="&#xE716;" />
                                        <TextBlock VerticalAlignment="Center" Text="{loc:Localize Nav_Clients}" />
                                    </StackPanel>
                                </Button>

                                <!--  Cases  -->
                                <Button
                                    x:Name="CasesButton"
                                    Click="NavigateToCases_Click"
                                    Style="{StaticResource NavButton}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource IconFont}"
                                            FontSize="18"
                                            Foreground="{StaticResource TextSecondaryBrush}"
                                            Text="&#xE8F1;" />
                                        <TextBlock VerticalAlignment="Center" Text="{loc:Localize Nav_Cases}" />
                                    </StackPanel>
                                </Button>

                                <!--  Documents  -->
                                <Button
                                    x:Name="DocumentsButton"
                                    Click="NavigateToDocuments_Click"
                                    Style="{StaticResource NavButton}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource IconFont}"
                                            FontSize="18"
                                            Foreground="{StaticResource TextSecondaryBrush}"
                                            Text="&#xE8A5;" />
                                        <TextBlock VerticalAlignment="Center" Text="{loc:Localize Nav_Documents}" />
                                    </StackPanel>
                                </Button>

                                <!--  Divider  -->
                                <Separator Margin="0,16" Style="{StaticResource Divider}" />

                                <!--  Backup  -->
                                <Button
                                    x:Name="BackupButton"
                                    Click="OpenBackup_Click"
                                    Style="{StaticResource NavButton}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource IconFont}"
                                            FontSize="18"
                                            Foreground="{StaticResource TextSecondaryBrush}"
                                            Text="&#xE895;" />
                                        <TextBlock VerticalAlignment="Center" Text="{loc:Localize Nav_Backup}" />
                                    </StackPanel>
                                </Button>

                                <!--  Settings  -->
                                <Button
                                    x:Name="SettingsButton"
                                    Click="OpenSettings_Click"
                                    Style="{StaticResource NavButton}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Center"
                                            FontFamily="{StaticResource IconFont}"
                                            FontSize="18"
                                            Foreground="{StaticResource TextSecondaryBrush}"
                                            Text="&#xE713;" />
                                        <TextBlock VerticalAlignment="Center" Text="{loc:Localize Nav_Settings}" />
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </ScrollViewer>

                        <!--  User Info at Bottom  -->
                        <Border
                            Grid.Row="1"
                            Margin="16,0,16,20"
                            Padding="12"
                            Background="{StaticResource SurfaceBrush}"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="12">
                            <StackPanel Orientation="Horizontal">
                                <Border
                                    Width="40"
                                    Height="40"
                                    Margin="0,0,12,0"
                                    Background="{StaticResource SecondaryBrush}"
                                    CornerRadius="20">
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Foreground="White"
                                        Text="A" />
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock
                                        FontSize="14"
                                        FontWeight="Medium"
                                        Foreground="{StaticResource TextPrimaryBrush}"
                                        Text="Administrateur" />
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{StaticResource SuccessBrush}"
                                        Text="{loc:Localize Status_Active}" />
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!--  Content Frame  -->
                <Frame
                    x:Name="MainContent"
                    Grid.Column="1"
                    NavigationUIVisibility="Hidden" />
            </Grid>
        </Grid>
    </Border>
</Window>