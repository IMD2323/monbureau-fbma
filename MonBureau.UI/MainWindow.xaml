<!--  MainWindow.xaml - Updated with Language Selector  -->
<Window
    x:Class="MonBureau.UI.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:MonBureau.UI.Controls"
    Title="MonBureau - Gestion de Cabinet"
    Width="1400"
    Height="800"
    MinWidth="1200"
    MinHeight="700"
    AllowsTransparency="True"
    Background="Transparent"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None">

    <Window.Resources>
        <FontFamily x:Key="IconFont">Segoe MDL2 Assets</FontFamily>

        <!--  Navigation Button Styles  -->
        <Style x:Key="NavButton" TargetType="Button">
            <Setter Property="Height" Value="50" />
            <Setter Property="Padding" Value="20,0" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="8">
                            <ContentPresenter
                                Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F3F4F6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style
            x:Key="ActiveNavButton"
            BasedOn="{StaticResource NavButton}"
            TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryLightBrush}" />
        </Style>
    </Window.Resources>

    <Border
        Background="{StaticResource SurfaceBrush}"
        BorderBrush="{StaticResource BorderBrush}"
        BorderThickness="1"
        CornerRadius="16">
        <Border.Effect>
            <DropShadowEffect
                BlurRadius="20"
                Opacity="0.15"
                ShadowDepth="0"
                Color="#000000" />
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="70" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  Custom Title Bar  -->
            <Border
                x:Name="HeaderBar"
                Grid.Row="0"
                Background="{StaticResource PrimaryBrush}"
                CornerRadius="16,16,0,0"
                MouseDown="HeaderBar_MouseDown">
                <Grid Margin="20,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!--  Logo & Title  -->
                    <StackPanel
                        Grid.Column="0"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <Border
                            Width="40"
                            Height="40"
                            Margin="0,0,12,0"
                            Background="White"
                            CornerRadius="10">
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontFamily="{StaticResource IconFont}"
                                FontSize="20"
                                Foreground="{StaticResource PrimaryBrush}"
                                Text="&#xE7C3;" />
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock
                                FontSize="18"
                                FontWeight="Bold"
                                Foreground="White"
                                Text="MonBureau" />
                            <TextBlock
                                FontSize="11"
                                Foreground="White"
                                Opacity="0.8"
                                Text="{Binding CurrentPageTitle}" />
                        </StackPanel>
                    </StackPanel>

                    <!--  ✅ NEW: Language Selector  -->
                    <controls:LanguageSelector
                        Grid.Column="2"
                        Margin="0,0,16,0"
                        VerticalAlignment="Center" />

                    <!--  Window Controls  -->
                    <StackPanel
                        Grid.Column="3"
                        VerticalAlignment="Center"
                        Orientation="Horizontal">
                        <Button
                            x:Name="MinimizeButton"
                            Width="40"
                            Height="40"
                            Click="MinimizeButton_Click"
                            Style="{StaticResource IconButton}">
                            <TextBlock
                                FontFamily="{StaticResource IconFont}"
                                FontSize="14"
                                Foreground="White"
                                Text="&#xE921;" />
                        </Button>

                        <Button
                            x:Name="MaximizeButton"
                            Width="40"
                            Height="40"
                            Click="MaximizeButton_Click"
                            Style="{StaticResource IconButton}">
                            <TextBlock
                                FontFamily="{StaticResource IconFont}"
                                FontSize="14"
                                Foreground="White"
                                Text="&#xE922;" />
                        </Button>

                        <Button
                            x:Name="CloseButton"
                            Width="40"
                            Height="40"
                            Click="CloseButton_Click"
                            Style="{StaticResource IconButton}">
                            <TextBlock
                                FontFamily="{StaticResource IconFont}"
                                FontSize="14"
                                Foreground="White"
                                Text="&#xE8BB;" />
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!--  Main Content Area  -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="240" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!--  Sidebar Navigation  -->
                <Border
                    Grid.Column="0"
                    Background="{StaticResource BackgroundBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,0,1,0">
                    <StackPanel Margin="0,20">
                        <!--  Dashboard  -->
                        <Button
                            x:Name="DashboardButton"
                            Click="NavigateToDashboard_Click"
                            Style="{StaticResource ActiveNavButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,12,0"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource IconFont}"
                                    FontSize="18"
                                    Foreground="White"
                                    Text="&#xE80F;" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    FontWeight="Medium"
                                    Foreground="White"
                                    Text="Tableau de Bord" />
                            </StackPanel>
                        </Button>

                        <!--  Clients  -->
                        <Button
                            x:Name="ClientsButton"
                            Margin="0,4,0,0"
                            Click="NavigateToClients_Click"
                            Style="{StaticResource NavButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,12,0"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource IconFont}"
                                    FontSize="18"
                                    Foreground="{StaticResource TextSecondaryBrush}"
                                    Text="&#xE716;" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Foreground="{StaticResource TextPrimaryBrush}"
                                    Text="Clients" />
                            </StackPanel>
                        </Button>

                        <!--  Cases  -->
                        <Button
                            x:Name="CasesButton"
                            Margin="0,4,0,0"
                            Click="NavigateToCases_Click"
                            Style="{StaticResource NavButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,12,0"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource IconFont}"
                                    FontSize="18"
                                    Foreground="{StaticResource TextSecondaryBrush}"
                                    Text="&#xE8F1;" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Foreground="{StaticResource TextPrimaryBrush}"
                                    Text="Dossiers" />
                            </StackPanel>
                        </Button>

                        <!--  Documents  -->
                        <Button
                            x:Name="DocumentsButton"
                            Margin="0,4,0,0"
                            Click="NavigateToDocuments_Click"
                            Style="{StaticResource NavButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,12,0"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource IconFont}"
                                    FontSize="18"
                                    Foreground="{StaticResource TextSecondaryBrush}"
                                    Text="&#xE8A5;" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Foreground="{StaticResource TextPrimaryBrush}"
                                    Text="Documents" />
                            </StackPanel>
                        </Button>

                        <!--  Separator  -->
                        <Separator Margin="20,20" Background="{StaticResource BorderBrush}" />

                        <!--  Backup  -->
                        <Button
                            x:Name="BackupButton"
                            Click="OpenBackup_Click"
                            Style="{StaticResource NavButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,12,0"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource IconFont}"
                                    FontSize="18"
                                    Foreground="{StaticResource TextSecondaryBrush}"
                                    Text="&#xE895;" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Foreground="{StaticResource TextPrimaryBrush}"
                                    Text="Sauvegarde" />
                            </StackPanel>
                        </Button>

                        <!--  Settings  -->
                        <Button
                            x:Name="SettingsButton"
                            Margin="0,4,0,0"
                            Click="OpenSettings_Click"
                            Style="{StaticResource NavButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    Margin="0,0,12,0"
                                    VerticalAlignment="Center"
                                    FontFamily="{StaticResource IconFont}"
                                    FontSize="18"
                                    Foreground="{StaticResource TextSecondaryBrush}"
                                    Text="&#xE713;" />
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    Foreground="{StaticResource TextPrimaryBrush}"
                                    Text="Paramètres" />
                            </StackPanel>
                        </Button>

                        <!--  User Info at Bottom  -->
                        <Border
                            Margin="20,40,20,20"
                            Padding="12"
                            Background="{StaticResource BackgroundBrush}"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="8">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <Border
                                        Width="32"
                                        Height="32"
                                        Margin="0,0,8,0"
                                        Background="{StaticResource AccentBrush}"
                                        CornerRadius="16">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            FontSize="14"
                                            FontWeight="Bold"
                                            Foreground="White"
                                            Text="A" />
                                    </Border>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock
                                            FontSize="13"
                                            FontWeight="Medium"
                                            Foreground="{StaticResource TextPrimaryBrush}"
                                            Text="Administrateur" />
                                        <TextBlock
                                            FontSize="11"
                                            Foreground="{StaticResource SuccessBrush}"
                                            Text="Licence Active" />
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!--  Content Frame  -->
                <Frame
                    x:Name="MainContent"
                    Grid.Column="1"
                    NavigationUIVisibility="Hidden" />
            </Grid>
        </Grid>
    </Border>
</Window>