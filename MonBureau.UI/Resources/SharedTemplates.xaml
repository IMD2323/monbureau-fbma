<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!--  ========================================  -->
    <!--  ACTION BUTTONS TEMPLATE (DataTemplate)  -->
    <!--  ========================================  -->
    <DataTemplate x:Key="ActionButtonsTemplate">
        <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
            <Button
                Margin="4,0"
                Padding="10"
                Command="{Binding DataContext.EditCommand, RelativeSource={RelativeSource AncestorType=Page}}"
                CommandParameter="{Binding}"
                ToolTip="Modifier">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Cursor" Value="Hand" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border
                                        x:Name="border"
                                        Padding="{TemplateBinding Padding}"
                                        Background="{TemplateBinding Background}"
                                        CornerRadius="6">
                                        <ContentPresenter />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#F3F4F6" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Button.Style>
                <TextBlock
                    FontFamily="Segoe MDL2 Assets"
                    FontSize="16"
                    Foreground="#2563EB"
                    Text="&#xE70F;" />
            </Button>

            <Button
                Margin="4,0"
                Padding="10"
                Command="{Binding DataContext.DeleteCommand, RelativeSource={RelativeSource AncestorType=Page}}"
                CommandParameter="{Binding}"
                ToolTip="Supprimer">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Cursor" Value="Hand" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border
                                        x:Name="border"
                                        Padding="{TemplateBinding Padding}"
                                        Background="{TemplateBinding Background}"
                                        CornerRadius="6">
                                        <ContentPresenter />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="#FEE2E2" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Button.Style>
                <TextBlock
                    FontFamily="Segoe MDL2 Assets"
                    FontSize="16"
                    Foreground="#EF4444"
                    Text="&#xE74D;" />
            </Button>
        </StackPanel>
    </DataTemplate>

    <!--  ========================================  -->
    <!--  LOADING OVERLAY (DataTemplate for ContentControl)  -->
    <!--  ========================================  -->
    <DataTemplate x:Key="LoadingOverlayTemplate">
        <Border
            Panel.ZIndex="999"
            Background="#80000000"
            Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar
                    Width="200"
                    Height="4"
                    Foreground="#2563EB"
                    IsIndeterminate="True" />
                <TextBlock
                    Margin="0,16,0,0"
                    HorizontalAlignment="Center"
                    FontSize="14"
                    Foreground="White"
                    Text="{Binding BusyMessage}" />
            </StackPanel>
        </Border>
    </DataTemplate>

    <!--  ========================================  -->
    <!--  PAGE HEADER (DataTemplate)  -->
    <!--  ========================================  -->
    <DataTemplate x:Key="PageHeaderTemplate">
        <Grid Margin="0,0,0,24">
            <StackPanel>
                <TextBlock
                    FontSize="28"
                    FontWeight="Bold"
                    Foreground="#111827"
                    Text="{Binding Title}" />
                <TextBlock
                    FontSize="14"
                    Foreground="#6B7280"
                    Text="{Binding Subtitle}" />
            </StackPanel>

            <Button
                Padding="20,12"
                HorizontalAlignment="Right"
                Command="{Binding AddCommand}"
                Style="{StaticResource ModernButton}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock
                        Margin="0,0,8,0"
                        FontFamily="Segoe MDL2 Assets"
                        Text="&#xE710;" />
                    <TextBlock Text="{Binding AddButtonText}" />
                </StackPanel>
            </Button>
        </Grid>
    </DataTemplate>

    <!--  ========================================  -->
    <!--  SEARCH BAR (DataTemplate)  -->
    <!--  ========================================  -->
    <DataTemplate x:Key="SearchBarTemplate">
        <Border
            Margin="0,0,0,24"
            Padding="24"
            Background="White"
            CornerRadius="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBox
                    Grid.Column="0"
                    Padding="16,12"
                    FontSize="14"
                    Style="{StaticResource ModernTextBox}"
                    Text="{Binding SearchFilter, UpdateSourceTrigger=PropertyChanged}" />

                <Button
                    Grid.Column="1"
                    Margin="12,0,0,0"
                    Padding="16,12"
                    Command="{Binding RefreshCommand}"
                    Style="{StaticResource OutlineButton}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock
                            Margin="0,0,8,0"
                            FontFamily="Segoe MDL2 Assets"
                            Text="&#xE72C;" />
                        <TextBlock Text="Actualiser" />
                    </StackPanel>
                </Button>

                <TextBlock
                    Grid.Column="2"
                    Margin="20,0,0,0"
                    VerticalAlignment="Center"
                    FontSize="14"
                    FontWeight="Medium"
                    Foreground="#6B7280">
                    <Run Text="{Binding Items.Count, Mode=OneWay}" />
                    <Run Text="/" />
                    <Run Text="{Binding TotalItems, Mode=OneWay}" />
                </TextBlock>
            </Grid>
        </Border>
    </DataTemplate>

    <!--  ========================================  -->
    <!--  PAGINATION (DataTemplate)  -->
    <!--  ========================================  -->
    <DataTemplate x:Key="PaginationTemplate">
        <Border
            Margin="0,16,0,0"
            Padding="16"
            HorizontalAlignment="Center"
            Background="White"
            BorderBrush="#E5E7EB"
            BorderThickness="1"
            CornerRadius="8"
            Visibility="{Binding Items.Count, Converter={StaticResource BoolToVis}}">
            <StackPanel Orientation="Horizontal">
                <Button
                    Padding="12,8"
                    Command="{Binding PreviousPageCommand}"
                    Content="◀ Précédent"
                    IsEnabled="{Binding CurrentPage, Converter={StaticResource GreaterThanOne}}"
                    Style="{StaticResource OutlineButton}" />

                <TextBlock
                    Margin="20,0"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Foreground="#111827">
                    <Run Text="Page" />
                    <Run FontWeight="Bold" Text="{Binding CurrentPage, Mode=OneWay}" />
                </TextBlock>

                <Button
                    Padding="12,8"
                    Command="{Binding NextPageCommand}"
                    Content="Suivant ▶"
                    Style="{StaticResource OutlineButton}" />
            </StackPanel>
        </Border>
    </DataTemplate>

    <!--  ========================================  -->
    <!--  EMPTY STATE (DataTemplate)  -->
    <!--  ========================================  -->
    <DataTemplate x:Key="EmptyStateTemplate">
        <Border
            Padding="60"
            HorizontalAlignment="Center"
            Background="White"
            CornerRadius="12"
            Visibility="{Binding Items.Count, Converter={StaticResource InverseBoolToVis}}">
            <StackPanel HorizontalAlignment="Center">
                <TextBlock
                    Margin="0,0,0,16"
                    HorizontalAlignment="Center"
                    FontSize="48"
                    Text="{Binding EmptyIcon}" />
                <TextBlock
                    Margin="0,0,0,8"
                    HorizontalAlignment="Center"
                    FontSize="18"
                    FontWeight="SemiBold"
                    Foreground="#111827"
                    Text="{Binding EmptyTitle}" />
                <TextBlock
                    HorizontalAlignment="Center"
                    FontSize="14"
                    Foreground="#6B7280"
                    Text="{Binding EmptyMessage}" />
            </StackPanel>
        </Border>
    </DataTemplate>

    <!--  ========================================  -->
    <!--  DIALOG BUTTONS (DataTemplate)  -->
    <!--  ========================================  -->
    <DataTemplate x:Key="DialogButtonsTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Button
                Grid.Column="1"
                Margin="0,0,12,0"
                Padding="24,12"
                Command="{Binding CancelCommand}"
                CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                Content="Annuler"
                Style="{StaticResource OutlineButton}" />

            <Button
                Grid.Column="2"
                Padding="24,12"
                Command="{Binding SaveCommand}"
                CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                Content="Enregistrer"
                Style="{StaticResource PrimaryButton}" />
        </Grid>
    </DataTemplate>

</ResourceDictionary>